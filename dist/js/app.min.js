!function(){"use strict";function e(e){function t(e,t,o,n){n.getObject("credencial")||(t.location.href=o.url+"login.html#?logout=true")}e.when("/",{templateUrl:"dist/views/home.html",resolve:{credenciais:t}}).when("/cadastrar",{templateUrl:"dist/views/cadastro.html",controller:"cadastro.ctrl"}).when("/gerenciar",{templateUrl:"dist/views/gerenciamento.html",controller:"gerenciamento.ctrl"}).when("/editar/:obraId",{templateUrl:"dist/views/editar_obra.html",controller:"editar_obra.ctrl"}).otherwise("/"),t.$inject=["api.autenticacao.service","$window","Constants","$cookies"]}function t(e,t,o,n,i){function a(e){console.log(e);var t="",o=(new Date).getHours();t=o>=5&&o<13?"Bom dia ":o>=13&&o<18?"Boa tarde ":"Boa noite ",$.notify({message:t+"<b>"+e.nome+"</b>! Tenha um ótimo trabalho."},{type:"success",animate:{enter:"animated fadeInDown",exit:"animated fadeOutUp"},icon:"glyphicon glyphicon-warning-sign",delay:5e3})}i.getObject("credencial")&&a(i.getObject("credencial"))}angular.module("app.gerenciador",["ngRoute","app.geogoncalo","file-model","ui.utils.masks","ngCookies"]).config(e).run(t),e.$inject=["$routeProvider"],t.$inject=["$rootScope","$location","api.service","$window","$cookies"]}();
!function(){"use strict";angular.module("app.geogoncalo",[])}();
!function(){"use strict";angular.module("app.login",["app.geogoncalo","ngCookies"])}();
!function(){"use strict";angular.module("app.mapa",["app.geogoncalo"])}();
!function(){angular.module("app.geogoncalo").constant("Constants",{url:"http://localhost:8080/geo_goncalo/"})}();
!function(){"use strict";function t(t,n){this.login=function(u){return t.post(n.url+"rest/autenticar/login",u)},this.logout=function(){return t.get(n.url+"rest/autenticar/logout")},this.autenticar=function(){return t.get(n.url+"rest/autenticar")}}angular.module("app.geogoncalo").service("api.autenticacao.service",["$http","Constants",t])}();
!function(){"use strict";function r(r,t){this.listarMarcadores=function(a){return r.get(t.url+"rest/marcadores")},this.listarMarcadoresPorCategoria=function(a){return r.get(t.url+"rest/marcadores/categoria/"+a)},this.selecionarMarcador=function(a){return r.get(t.url+"rest/marcador/"+a)},this.cadastrarMarcador=function(a){return r.post(t.url+"rest/marcadores",a)},this.atuarlizarMarcador=function(a,e){return r.put(t.url+"rest/marcador/"+a,e)},this.deletarMarcador=function(a){return r["delete"](t.url+"rest/marcador/"+a)},this.listarTipos=function(){return r.get(t.url+"rest/tipos")},this.listarCategorias=function(){return r.get(t.url+"rest/categorias")},this.listarCategoriasPorTipo=function(a){return r.get(t.url+"rest/categoria/tipo/"+a)},this.selecionarObra=function(a){return r.get(t.url+"rest/obra/"+a)},this.listarObras=function(){return r.get(t.url+"rest/obras")},this.atualizarObra=function(a){return r.put(t.url+"rest/obra/"+a.id,a)},this.atualizarStatusObra=function(a,e){return r.put(t.url+"rest/obra/"+a+"/status/"+e)},this.listarObrasRelacionadas=function(a,e){return r.get(t.url+"rest/obra/"+a+"/categoria/"+e+"/relacionados")},this.listarStatus=function(){return r.get(t.url+"rest/status")},this.uploadImagem=function(a,e){var s=new FormData;return s.append("file",a),s.append("obraId",e),r.post(t.url+"rest/arquivo/upload/"+e,s,{transformRequest:angular.identity,headers:{"Content-Type":void 0}})}}angular.module("app.geogoncalo").service("api.service",["$http","Constants",r])}();
!function(){"use strict";function n(n,o){n.$on("LOAD",function(){n.loading=!0}),n.$on("UNLOAD",function(){o(function(){n.loading=!1},500)})}angular.module("app.gerenciador").controller("app.controller",n),n.$inject=["$scope","$timeout"]}();
!function(){"use strict";function a(a,o,t,r,e,n,i,s){var c,d,l,m;a.marcador={},a.marcador.obra={},a.cadastrarMarcador=function(t){var r=a.myFile;a.$emit("LOAD"),o.cadastrarMarcador(t).then(function(t){a.marcador={},r&&o.uploadImagem(r,t.data.obra.id).then(function(o){a.myfile={},d.setMap(null),a.$emit("UNLOAD"),i(function(){$.notify({message:"Obra cadastrada com sucesso!"},{type:"success"}),$("#modal-cadastrar").modal("hide")},600)},function(o){$.notify({message:"Obra cadastrada com sucesso porém ocorreu um erro ao enviar a(s) imagens."},{type:"warning"}),a.$emit("UNLOAD")})},function(o){$.notify({message:"Ocorreu um erro ao cadastrar a obra, tente novamente. Se o erro persistir, contact o administrador do sistema."},{type:"warning"}),a.$emit("UNLOAD")})},a.listarTipos=function(){o.listarTipos().then(function(o){a.tipos=o.data},null)},a.setCategorias=function(o){a.categorias=angular.copy(o)},a.listarCategoriasPorTipo=function(t){o.listarCategoriasPorTipo(t).then(function(o){a.categorias=o.data},null)},a.listarStatus=function(){o.listarStatus().then(function(o){a.status=o.data},null)}(),a.modalCadastro=function(){$("#modal-cadastrar").modal("show")},a.initMap=function(){c=new google.maps.Map(document.getElementById("mapa"),{center:{lat:-5.7968718,lng:-35.4148505},zoom:12}),l=new google.maps.Geocoder,d=new google.maps.Marker({map:c}),google.maps.event.addListener(c,"click",function(o){d.setMap(c),a.marcador={},a.marcador.obra={},a.marcador.latitude=o.latLng.lat(),a.marcador.longitude=o.latLng.lng();var r=new google.maps.LatLng(a.marcador.latitude,a.marcador.longitude);c.panTo(r),d.setPosition(r),console.log("teste"),l.geocode({location:r},function(o,r){if(r===google.maps.GeocoderStatus.OK){o[0]&&(a.marcador.obra.rua=o[0].formatted_address);var e="<div.content><h4>"+o[0].formatted_address+'</h4><button class="btn btn-primary" ng-click="modalCadastro()">Cadastrar obra</button></div>',n=t(e)(a);m?m.setContent(n[0]):m=new google.maps.InfoWindow({content:n[0]}),m.open(c,d)}})})}(),a.listarTipos()}angular.module("app.gerenciador").controller("cadastro.ctrl",a),a.$inject=["$scope","api.service","$compile","api.autenticacao.service","$window","Constants","$timeout","$location"]}();
!function(){"use strict";function t(t,a,i,o){t.init=function(){a.listarTipos().then(function(a){t.tipos=a.data}),a.selecionarMarcador(i.obraId).then(function(a){t.marcador=a.data},null),a.listarCategorias().then(function(a){t.categorias=a.data})}(),t.listarTipos=function(){a.listarTipos().then(function(a){t.tipos=a.data},null)},t.listarCategoriasPorTipo=function(i){a.listarCategoriasPorTipo(i).then(function(a){t.categorias=a.data},null)},t.listarStatus=function(){a.listarStatus().then(function(a){t.statusList=a.data},null)}(),t.atualizarObra=function(i){t.$emit("LOAD"),a.atualizarObra(i).then(function(a){t.$emit("UNLOAD"),$.notify({message:"Obra atualizada com sucesso!"},{type:"success"}),o.path("/gerenciar")},function(a){t.$emit("UNLOAD"),$.notify({message:"Ocorreu um erro ao atualizar a obra, tente novamente. Se o erro persistir, contacte o administrador do sistema."},{type:"success"})})},t.listarTipos()}angular.module("app.gerenciador").controller("editar_obra.ctrl",t),t.$inject=["$scope","api.service","$routeParams","$location"]}();
!function(){"use strict";function t(t,a,e){t.$emit("UNLOAD"),t.listarMarcadores=function(){t.$emit("LOAD"),a.listarMarcadores().then(function(a){t.marcadores=a.data,t.$emit("UNLOAD")},function(a){t.$emit("UNLOAD"),$.notify({message:"Ocorreu um erro ao listar as obras, tente novamente. Se o erro persistir, contact o administrador do sistema."},{type:"warning"})})},t.deletarMarcador=function(e){t.$emit("LOAD"),a.deletarMarcador(e).then(function(a){$.notify({message:"A obra foi deletada com sucesso!"},{type:"success"}),t.listarMarcadores()},function(a){$.notify({message:"Ocorreu um erro ao deletar a obra, tente novamente. Se o erro persistir, contacte o administrador do sistema."},{type:"warning"}),t.$emit("UNLOAD")})},t.listarStatus=function(){a.listarStatus().then(function(a){t.statusList=a.data},null)}(),t.listarTipos=function(){a.listarTipos().then(function(a){t.tipos=a.data},null)}(),t.listarCategoriasPorTipo=function(e){a.listarCategoriasPorTipo(e).then(function(a){t.categorias=a.data},null)},t.atualizarStatusObra=function(e,o){t.$emit("LOAD"),a.atualizarStatusObra(e,o).then(function(a){$.notify({message:"O status da obra foi atualizado com sucesso!"},{type:"success"}),t.$emit("UNLOAD")},function(a){$.notify({message:"Ocorreu um erro ao atualizar o status da obra, tente novamente. Se o erro persistir, contacte o administrador do sistema."},{type:"warning"}),t.$emit("UNLOAD")})},t.listarStatus=function(){a.listarStatus().then(function(a){t.status=a.data})}(),t.listarMarcadores()}angular.module("app.gerenciador").controller("gerenciamento.ctrl",["$scope","api.service","$route",t])}();
!function(){"use strict";function n(n){n.itens=[{link:"#/",nome:"Inicio",icone:"fa fa-home"},{link:"#/gerenciar",nome:"Gerenciar obras",icone:"fa fa-list"},{link:"#/cadastrar",nome:"Cadastrar Obras",icone:"fa fa-plus"}]}angular.module("app.gerenciador").controller("menu.ctrl",["$scope",n])}();
!function(){"use strict";function o(o,n,e,t,c,i){var a=e.search();console.log(a),"true"==a.logout&&c.logout().then(function(o){$.notify({message:"Logout efetuado com sucesso!"},{type:"success"}),i.put("credencial",null)}),o.login=function(o){$.notify({message:"Efetuando login."},{type:"info"}),c.login(o).then(function(o){i.putObject("credencial",o.data.funcionario),n.location=t.url},function(o){$.notify({message:"Login ou senha incorretos. Tente novamente."},{type:"danger"})})}}angular.module("app.login").controller("login.ctrl",o),o.$inject=["$scope","$window","$location","Constants","api.autenticacao.service","$cookies"]}();
!function(){"use strict";function a(a,o){var r;a.listarMarcadores=function(){o.listarMarcadores().then(function(o){a.marcadores=o.data,a.gerarMarcadores(a.marcadores)},null)},a.listarRelacionados=function(r,e){o.listarObrasRelacionadas(r,e).then(function(o){a.relacionados=o.data,console.log(a.relacionados)})},a.exibirObra=function(r){o.selecionarObra(r).then(function(o){a.marcador={},a.marcador.obra=o.data,a.listarRelacionados(r,a.marcador.obra.categoria.id)})},a.initMap=function(){r=new google.maps.Map(document.getElementById("mapa"),{center:{lat:-5.7968718,lng:-35.4148505},zoom:12}),a.listarMarcadores()}(),a.gerarMarcadores=function(o){for(var e=0;e<o.length;e++){var n=new google.maps.Marker({position:{lat:parseFloat(o[e].latitude),lng:parseFloat(o[e].longitude)},map:r,title:o[e].obra.categoria.denominacao,animation:google.maps.Animation.DROP,icon:"dist/img/50x60/ico_"+o[e].obra.categoria.id+".png",categoria:o[e].obra.categoria.denominacao});!function(e,n){google.maps.event.addListener(e,"mousedown",function(){a.marcador=o[n],a.listarRelacionados(o[n].obra.id,o[n].obra.categoria.id),$("#modal-obra").modal("show"),r.panTo({lat:parseFloat(o[n].latitude),lng:parseFloat(o[n].longitude)}),a.$apply()})}(n,e),n.setMap(r)}}}angular.module("app.mapa").controller("mapa.ctrl",["$scope","api.service",a])}();
!function(){"use strict";function e(e,c,t,o,n){o.getObject("credencial")&&(e.credencial=o.getObject("credencial"))}angular.module("app.gerenciador").controller("menu.top.ctrl",e),e.$inject=["$scope","$route","$timeout","$cookies","$compile"]}();
//# sourceMappingURL=app.min.js.map
